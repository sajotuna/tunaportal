<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper
	namespace="co.fourth.tuna.domain.portalNotice.mapper.PortalNoticeMapper">
	

<select id="noticeList" parameterType="co.fourth.tuna.domain.portalNotice.vo.PortalNoticeVO"
	resultType="co.fourth.tuna.domain.portalNotice.vo.PortalNoticeVO">
SELECT * FROM PORTALNOTICE
WHERE
<if test="state == 1">1 = 1 </if>
<if test="state == 2">title like '%'||#{key}||'%' </if>
<if test="state == 3">content like '%'||#{key}||'%'</if>
ORDER BY NO DESC
</select>

<select id="noticeSelect" 
	parameterType="co.fourth.tuna.domain.portalNotice.vo.PortalNoticeVO"
	resultType="co.fourth.tuna.domain.portalNotice.vo.PortalNoticeVO">
SELECT * FROM PORTALNOTICE
WHERE no = #{no}
</select>

<insert id="noticeInsert"
		parameterType="co.fourth.tuna.domain.portalNotice.vo.PortalNoticeVO">

<selectKey resultType="int" keyProperty="id" order="BEFORE">
			SELECT CASE WHEN MAX(NO)!= 0 THEN MAX(NO) + 1 
						ELSE 1 END AS ID FROM PORTALNOTICE;
</selectKey>
INSERT INTO PORTALNOTICE(no, content, title, visible, adno, enrolldate)
VALUES (#{id}, #{CONTENT}, #{TITLE}, #{VISIBLE}, 100482, sysdate)
</insert>

<insert id="fileInsert"
		parameterType="co.fourth.tuna.domain.portalNotice.vo.PortalNoticeFileVO">
<selectKey resultType="int" keyProperty="id" order="BEFORE">
			SELECT CASE WHEN MAX(NO)!= 0 THEN MAX(NO) + 1 
						ELSE 1 END AS ID FROM PORTALNOTICE</selectKey>
INSERT INTO PORTALFILE
VALUES (#{id}, #{name}, #{uri}, #{pnno})	
</insert>

<delete id="noticeDelete" parameterType="int">
DELETE FROM PORTALNOTICE WHERE NO = #{no}
</delete>

<delete id="fileDelete" parameterType="int">
DELETE FROM PORTALFILE WHERE NO = #{pnno}
</delete>

</mapper>
