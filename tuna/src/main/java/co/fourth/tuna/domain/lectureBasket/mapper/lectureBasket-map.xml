<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper
	namespace="co.fourth.tuna.domain.lectureBasket.mapper.LectureBasketMapper">

<!--  <insert id = "baskInsert" parameterType="co.fourth.tuna.domain.lectureBasket.vo.LectureBasketVO">
	<selectKey order="BEFORE" keyProperty="no" resultType="string">
		SELECT NVL(MAX(no)+1,0) no FROM LECTUREBASKET
	</selectKey>

insert into LECTUREBASKET values (#{no}, 'y', #{seasonCode}, #{sbjNo}, #{stNo})

</insert> 
 -->
<insert id="baskInsert" statementType="CALLABLE" parameterType="co.fourth.tuna.domain.lectureBasket.vo.LectureBasketVO">
	{ call courseBasket( 
		#{sbjNo},
		#{seasonCode}, 
		#{stNo}) 
	}
</insert>

<delete id ="baskDelete" parameterType="co.fourth.tuna.domain.lectureBasket.vo.LectureBasketVO">

DELETE FROM LECTUREBASKET WHERE SBJNO = #{sbjNo}

</delete>
<delete id ="courDelete" parameterType="co.fourth.tuna.domain.lectureBasket.vo.LectureBasketVO">

DELETE FROM LECTUREAPPLY WHERE SBJNO = #{sbjNo}

</delete>

<select id ="FindRoom" parameterType="map" resultType="boolean">

SELECT case when count(*) >= 1 then 1 else 0 end as truefalse
  FROM lecturebasket l, lectureschedule ls
 WHERE ls.sbjno = l.sbjno 
   AND l.stno = #{stNo} 
   AND l.seasoncode = 106 
   AND (ls.daycode = #{day} 
   AND ls.timecode between #{startTime} 
   AND #{endTime})


</select>

<select id = "FindCourseGrade" parameterType="co.fourth.tuna.domain.lectureBasket.vo.LectureBasketVO" resultType="String">
		SELECT CourseApplyGrade(#{stNo}) FROM dual
</select>

<select id = "FindSubject" parameterType="co.fourth.tuna.domain.lectureBasket.vo.LectureBasketVO" resultType="boolean">
	SELECT case when count(*) >= 1 then 1 else 0 end as truefalse 
	  FROM lecturebasket 
	 WHERE sbjno = #{sbjNo}
</select>	

<!-- <parameterMap type="co.fourth.tuna.domain.lectureBasket.vo.LectureBasketVO" id="basketParam">
	<parameter property="sbjNo" mode="IN" jdbcType="VARCHAR" javaType="string"/>
	<parameter property="seasonCode" mode="IN" jdbcType="VARCHAR" javaType="string"/>
	<parameter property="stNo" mode="IN" jdbcType="VARCHAR" javaType="string"/>
</parameterMap>
<insert id="baskInsert" statementType="CALLABLE" parameterMap="basketParam">
	{ call courseBasket(?,?,?) }
</insert>
 -->


</mapper>